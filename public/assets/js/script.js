"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}var AttrHelper=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"toggleClass",value:function(t,e){for(var i=t.className.split(/\s+/),n=i.length,a=0;a<n;a++)if(i[a]===e){i.splice(a,1);break}n===i.length&&i.push(e),t.className=i.join(" ")}},{key:"hasClass",value:function(t,e){return-1!==t.className.indexOf(e)}},{key:"removeElementsByClass",value:function(t){if(t.length>0)for(var e=t.length-1;e>=0;e--)t[e].parentNode.removeChild(t[e])}}]),t}(),PositionHelper=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"isScrolledIntoView",value:function(t){var e=t.getBoundingClientRect(),i=e.top,n=e.bottom;return i<window.innerHeight&&n>=0}}]),t}(),Animations=function(){function t(){_classCallCheck(this,t),this.animations={},this.speed=100,this.position_helper=new PositionHelper}return _createClass(t,[{key:"init",value:function(){var t=this;this.animations=Array.prototype.slice.call(document.querySelectorAll("[data-animation]")),this.animations.forEach(function(e){t.position_helper.isScrolledIntoView(e)&&t.animate(e)}),window.addEventListener("scroll",function(e){t.animations.forEach(function(e){t.position_helper.isScrolledIntoView(e)&&t.animate(e)})})}},{key:"animate",value:function(t){var e=t.dataset.animation||t.getAttribute("animation"),i=t.dataset.animationSpeed||this.speed;i=isNaN(i)?this.speed:i,"function"==typeof this[e]&&this[e](t,i),this.removeAnimation(t)}},{key:"typewriter",value:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=(n=0==n.length?t.innerHTML:n).length;t.innerHTML=a,a+=n.charAt(o),t.innerHTML=a+"<span class='typwriter__blink'>_</span>",o<s&&(o++,setTimeout(function(){i.typewriter(t,e,n,a,o)},e))}},{key:"removeAnimation",value:function(t){t.removeAttribute("data-animation"),this.animations=Array.prototype.slice.call(document.querySelectorAll("[data-animation]"))}}]),t}(),animations=new Animations,ChatBox=function(){function t(){_classCallCheck(this,t),this.attr_helper=new AttrHelper,this.chatbox="",this.container="",this.chatbox_form="",this.chatbox_list="",this.chatbox_message_box="",this.welcome="",this.initiated=!1}return _createClass(t,[{key:"init",value:function(){var t=this;this.chatbox=document.querySelector(".chat-box"),null!==this.chatbox&&(this.container=this.chatbox.parentNode,this.chatbox_form=this.chatbox.querySelector(".chat-box__form"),this.chatbox_list=this.chatbox.querySelector(".chat-box__list"),this.welcome=document.getElementsByClassName("welcome"),this.chatbox_message_box=this.chatbox_form.querySelector("#message"),this.chatbox_form.addEventListener("submit",function(e){e.preventDefault(),t.initiated||t.initiateContainer(),t.chat()}))}},{key:"initiateContainer",value:function(){this.initiated=!0,this.attr_helper.removeElementsByClass(this.welcome),this.attr_helper.hasClass(this.container,"h-100")||this.attr_helper.toggleClass(this.container,"h-100")}},{key:"chat",value:function(){var t=this,e=this.chatbox_message_box.value;this.chatbox_message_box.value="",this.insertBubble(e,"text","human");var i="",n=new FormData,a={driver:"web",userId:"1",message:e,attachment:null,interactive:!1,attachment_data:document.getElementById("attachment").files[0]};Object.keys(a).forEach(function(t){return n.append(t,a[t])}),axios.post("/api/botman",n).then(function(e){(e.data.messages||[]).forEach(function(e){i=e.text,t.insertBubble(i,"text","purebot")})}).catch(function(t){console.log(t)})}},{key:"insertBubble",value:function(t,e,i){var n=document.createElement("span"),a=document.createTextNode(t);n.appendChild(a),n.classList.add("chat-box__list__bubble"),n.classList.add("chat-box__list__bubble__"+i),this.chatbox_list.appendChild(n),this.chatbox_list.scrollTop=this.chatbox_list.scrollHeight,this.chatbox_message_box.focus()}}]),t}(),chatbox=new ChatBox,SideBar=function(){function t(){_classCallCheck(this,t),this.attr_helper=new AttrHelper}return _createClass(t,[{key:"init",value:function(){var t=this,e=document.getElementById("layout"),i=document.getElementById("menu"),n=document.getElementById("menuLink"),a=document.getElementById("main"),o=[e,i,n];n.onclick=function(e){t.toggleSideBar(e,o,"active")},a.onclick=function(e){t.attr_helper.hasClass(i,"active")&&t.toggleSideBar(e,o,"active")}}},{key:"toggleSideBar",value:function(t,e,i){var n=this;t.preventDefault(),e.forEach(function(t){n.attr_helper.toggleClass(t,i)})}}]),t}(),sideBar=new SideBar;sideBar.init(),animations.init(),chatbox.init(),AOS.init({offset:0,delay:50,duration:1e3,easing:"linear"});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyIsImhlbHBlci9hdHRyX2hlbHBlci5qcyIsImhlbHBlci9wb3NpdGlvbl9oZWxwZXIuanMiLCJsYXlvdXQvYW5pbWF0aW9ucy5qcyIsImxheW91dC9jaGF0Ym94LmpzIiwibGF5b3V0L3NpZGViYXIuanMiXSwibmFtZXMiOlsiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9kZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5Iiwia2V5IiwiX2NyZWF0ZUNsYXNzIiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwicHJvdG90eXBlIiwiQXR0ckhlbHBlciIsInRoaXMiLCJ2YWx1ZSIsImVsZW1lbnQiLCJjbGFzc05hbWUiLCJjbGFzc2VzIiwic3BsaXQiLCJzcGxpY2UiLCJwdXNoIiwiam9pbiIsImluZGV4T2YiLCJlbGVtZW50cyIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsIlBvc2l0aW9uSGVscGVyIiwiZWwiLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiZWxfdG9wIiwidG9wIiwiZWxfYm90IiwiYm90dG9tIiwid2luZG93IiwiaW5uZXJIZWlnaHQiLCJBbmltYXRpb25zIiwiYW5pbWF0aW9ucyIsInNwZWVkIiwicG9zaXRpb25faGVscGVyIiwiX3RoaXMiLCJBcnJheSIsInNsaWNlIiwiY2FsbCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJhbmltYXRpb24iLCJpc1Njcm9sbGVkSW50b1ZpZXciLCJhbmltYXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJhbmltYXRpb25fdHlwZSIsImRhdGFzZXQiLCJnZXRBdHRyaWJ1dGUiLCJhbmltYXRpb25fc3BlZWQiLCJhbmltYXRpb25TcGVlZCIsImlzTmFOIiwicmVtb3ZlQW5pbWF0aW9uIiwiX3RoaXMyIiwiZnVsbF9zdHJpbmciLCJhcmd1bWVudHMiLCJ1bmRlZmluZWQiLCJ0ZW1wX3N0cmluZyIsImxpbWl0IiwiaW5uZXJIVE1MIiwiY2hhckF0Iiwic2V0VGltZW91dCIsInR5cGV3cml0ZXIiLCJyZW1vdmVBdHRyaWJ1dGUiLCJDaGF0Qm94IiwiYXR0cl9oZWxwZXIiLCJjaGF0Ym94IiwiY29udGFpbmVyIiwiY2hhdGJveF9mb3JtIiwiY2hhdGJveF9saXN0IiwiY2hhdGJveF9tZXNzYWdlX2JveCIsIndlbGNvbWUiLCJpbml0aWF0ZWQiLCJfdGhpczMiLCJxdWVyeVNlbGVjdG9yIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInByZXZlbnREZWZhdWx0IiwiaW5pdGlhdGVDb250YWluZXIiLCJjaGF0IiwicmVtb3ZlRWxlbWVudHNCeUNsYXNzIiwiaGFzQ2xhc3MiLCJ0b2dnbGVDbGFzcyIsIl90aGlzNCIsIm1lc3NhZ2UiLCJpbnNlcnRCdWJibGUiLCJwdXJlYm90X21lc3NhZ2UiLCJkYXRhIiwiRm9ybURhdGEiLCJwb3N0RGF0YSIsImRyaXZlciIsInVzZXJJZCIsImF0dGFjaG1lbnQiLCJpbnRlcmFjdGl2ZSIsImF0dGFjaG1lbnRfZGF0YSIsImdldEVsZW1lbnRCeUlkIiwiZmlsZXMiLCJrZXlzIiwiYXBwZW5kIiwiYXhpb3MiLCJwb3N0IiwidGhlbiIsInJlc3BvbnNlIiwibWVzc2FnZXMiLCJtc2ciLCJ0ZXh0IiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwidHlwZSIsInNvdXJjZSIsImJ1YmJsZSIsImNyZWF0ZUVsZW1lbnQiLCJjcmVhdGVUZXh0Tm9kZSIsImFwcGVuZENoaWxkIiwiY2xhc3NMaXN0IiwiYWRkIiwic2Nyb2xsVG9wIiwic2Nyb2xsSGVpZ2h0IiwiZm9jdXMiLCJTaWRlQmFyIiwiX3RoaXM1IiwibGF5b3V0IiwibWVudSIsIm1lbnVMaW5rIiwiY29udGVudCIsInRvZ2dsZWRFbGVtZW50Iiwib25jbGljayIsInRvZ2dsZVNpZGVCYXIiLCJhY3RpdmUiLCJfdGhpczYiLCJzaWRlQmFyIiwiaW5pdCIsIkFPUyIsIm9mZnNldCIsImRlbGF5IiwiZHVyYXRpb24iLCJlYXNpbmciXSwibWFwcGluZ3MiOiJBQUFBLGFBRUEsU0FBU0EsZ0JBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELGFBQW9CQyxHQUFnQixNQUFNLElBQUlDLFVBQVUscUNBRWhILFNBQVNDLGtCQUFrQkMsRUFBUUMsR0FBUyxJQUFLLElBQUlDLEVBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLElBQUlFLEVBQWFILEVBQU1DLEdBQUlFLEVBQVdDLFdBQWFELEVBQVdDLGFBQWMsRUFBT0QsRUFBV0UsY0FBZSxFQUFVLFVBQVdGLElBQVlBLEVBQVdHLFVBQVcsR0FBTUMsT0FBT0MsZUFBZVQsRUFBUUksRUFBV00sSUFBS04sSUFFN1MsU0FBU08sYUFBYWQsRUFBYWUsRUFBWUMsR0FBbUosT0FBaElELEdBQVliLGtCQUFrQkYsRUFBWWlCLFVBQVdGLEdBQWlCQyxHQUFhZCxrQkFBa0JGLEVBQWFnQixHQUFxQmhCLEVBRXpNLElDUkFrQixXRFVBLFdBQ0UsU0FBU0EsSUFDUHBCLGdCQUFnQnFCLEtBQU1ELEdBd0N4QixPQXJDQUosYUFBYUksRUFBWSxDQUFDLENBQ3hCTCxJQUFLLGNBQ0xPLE1BQU8sU0NoQlhDLEVBQUFDLEdBS0EsSUFKQSxJQUFBQyxFQUFBRixFQUFBQyxVQUFBRSxNQUFBLE9BQ0FsQixFQUFBaUIsRUFBQWpCLE9BQ0FELEVBQUEsRUFFQUEsRUFBQUMsRUFBQUQsSUFDQSxHQUFBa0IsRUFBQWxCLEtBQUFpQixFQUFBLENBQ0FDLEVBQUFFLE9BQUFwQixFQUFBLEdBQ0EsTUFJQUMsSUFBQWlCLEVBQUFqQixRQUNBaUIsRUFBQUcsS0FBQUosR0FHQUQsRUFBQUMsVUFBQUMsRUFBQUksS0FBQSxPRG1CSyxDQUNEZCxJQUFLLFdBQ0xPLE1BQU8sU0NsQlhDLEVBQUFDLEdBQ0EsT0FBQSxJQUFBRCxF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LEdBQ0EyRSxFQUFBdkQsWUFBQWUsU0FBQTBDLEVBUEEsV0FRQUYsRUFBQU8sY0FBQWxGLEVBQUFnRixFQVJBLGFMb1RLLENBQ0Q1SCxJQUFLLGdCQUNMTyxNQUFPLFNLelNYcUMsRUFBQTVCLEVBQUErRyxHQUFBLElBQUFDLEVBQUExSCxLQUNBc0MsRUFBQStCLGlCQUNBM0QsRUFBQXVCLFFBQUEsU0FBQS9CLEdBQ0F3SCxFQUFBaEUsWUFBQWdCLFlBQUF4RSxFQUFBdUgsU0xnVFNULEVBekNULEdLbFFBVyxRQUFBLElBQUFYLFFMeENBVyxRQUFBQyxPQUdBcEcsV0FBQW9HLE9BR0FqRSxRQUFBaUUsT0FHQUMsSUFBQUQsS0FBQSxDQUNBRSxPQUFBLEVBQ0FDLE1BQUEsR0FDQUMsU0FBQSxJQUNBQyxPQUFBIiwiZmlsZSI6InNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vSW5jbHVkZSBKUyBmaWxlcyBmcm9tIGluY2x1ZGUgZm9sZGVyIGhlcmUgYW5kIHNvcnQgdGhlbSBhY2NvcmRpbmcgdG8gaXRzIGRlcGVuZGVuY2llc1xyXG5cclxuLy9DYWxsIHNpZGViYXIuanNcclxuc2lkZUJhci5pbml0KClcclxuXHJcbi8vQ2FsbCBhbmltYXRpb25zLmpzXHJcbmFuaW1hdGlvbnMuaW5pdCgpXHJcblxyXG4vL0NhbGwgY2hhdGJveC5qc1xyXG5jaGF0Ym94LmluaXQoKVxyXG5cclxuLy9DYWxsIGFvcy5qc1xyXG5BT1MuaW5pdCh7XHJcbiAgICBvZmZzZXQ6IDAsXHJcbiAgICBkZWxheTogNTAsIC8vIHZhbHVlcyBmcm9tIDAgdG8gMzAwMCwgd2l0aCBzdGVwIDUwbXNcclxuICAgIGR1cmF0aW9uOiAxMDAwLCAvLyB2YWx1ZXMgZnJvbSAwIHRvIDMwMDAsIHdpdGggc3RlcCA1MG1zXHJcbiAgICBlYXNpbmc6ICdsaW5lYXInLCAvLyBkZWZhdWx0IGVhc2luZyBmb3IgQU9TIGFuaW1hdGlvbnNcclxufSkiLCJjbGFzcyBBdHRySGVscGVyIHtcclxuICAgIHRvZ2dsZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xyXG4gICAgICAgIGxldCBjbGFzc2VzID0gZWxlbWVudC5jbGFzc05hbWUuc3BsaXQoL1xccysvKSxcclxuICAgICAgICAgICAgbGVuZ3RoID0gY2xhc3Nlcy5sZW5ndGgsXHJcbiAgICAgICAgICAgIGkgPSAwXHJcblxyXG4gICAgICAgIGZvcig7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgaWYgKGNsYXNzZXNbaV0gPT09IGNsYXNzTmFtZSkge1xyXG4gICAgICAgICAgICBjbGFzc2VzLnNwbGljZShpLCAxKVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gVGhlIGNsYXNzTmFtZSBpcyBub3QgZm91bmRcclxuICAgICAgICBpZiAobGVuZ3RoID09PSBjbGFzc2VzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjbGFzc2VzLnB1c2goY2xhc3NOYW1lKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc2VzLmpvaW4oJyAnKVxyXG4gICAgfVxyXG5cclxuICAgIGhhc0NsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xyXG4gICAgICByZXR1cm4gZWxlbWVudC5jbGFzc05hbWUuaW5kZXhPZihjbGFzc05hbWUpICE9PSAtMVxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUVsZW1lbnRzQnlDbGFzcyhlbGVtZW50cykge1xyXG4gICAgICBpZihlbGVtZW50cy5sZW5ndGggPiAwKXtcclxuICAgICAgICBmb3IobGV0IGkgPSBlbGVtZW50cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XHJcbiAgICAgICAgICBlbGVtZW50c1tpXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnRzW2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxufSIsImNsYXNzIFBvc2l0aW9uSGVscGVyIHtcclxuICAgIGlzU2Nyb2xsZWRJbnRvVmlldyhlbCkge1xyXG4gICAgICBsZXQgcmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICBsZXQgZWxfdG9wID0gcmVjdC50b3A7XHJcbiAgICAgIGxldCBlbF9ib3QgPSByZWN0LmJvdHRvbTtcclxuXHJcbiAgICAgIC8vbGV0IGlzVmlzaWJsZSA9IChlbF90b3AgPj0gMCkgJiYgKGVsX2JvdCA8PSB3aW5kb3cuaW5uZXJIZWlnaHQpXHJcbiAgICAgIFxyXG4gICAgICBsZXQgaXNWaXNpYmxlID0gZWxfdG9wIDwgd2luZG93LmlubmVySGVpZ2h0ICYmIGVsX2JvdCA+PSAwO1xyXG4gICAgICByZXR1cm4gaXNWaXNpYmxlO1xyXG4gIH1cclxufSIsIi8qXHJcbipcclxuQW5pbWF0aW9ucyBDbGFzcyAtIGJ5IHNjYXZlbnR1bVxyXG4qXHJcblVzYWdlOlxyXG4xLiBBZGQgPGRhdGEtYW5pbWF0aW9uPVwiW29wdGlvbnNdXCI+IGFzIHJlcXVpcmVkIGVsZW1lbnQgYXR0cmlidXRlLlxyXG4gICBbb3B0aW9uc10gYXZhaWxhYmxlOlxyXG4gICAtIHR5cGV3cml0ZXJcclxuMi4gQWRkIDxkYXRhLWFuaW1hdGlvbi1zcGVlZD1cIlt2YWx1ZV1cIj4gYXMgb3B0aW9uYWwgZWxlbWVudCBhdHRyaWJ1dGUuXHJcbiAgIFt2YWx1ZV06IHBvc2l0aXZlIGludGVnZXIgaW4gbWlsbGlzZWNvbmRzIFxyXG4qXHJcbiovXHJcblxyXG5jbGFzcyBBbmltYXRpb25zIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuYW5pbWF0aW9ucyA9IHt9XHJcbiAgICAgICAgdGhpcy5zcGVlZCA9IDEwMFxyXG4gICAgICAgIHRoaXMucG9zaXRpb25faGVscGVyID0gbmV3IFBvc2l0aW9uSGVscGVyKClcclxuICAgIH1cclxuXHJcbiAgICBpbml0KCl7XHJcbiAgICAgICAgdGhpcy5hbmltYXRpb25zID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltkYXRhLWFuaW1hdGlvbl1cIikpXHJcblxyXG4gICAgICAgIHRoaXMuYW5pbWF0aW9ucy5mb3JFYWNoKChhbmltYXRpb24pID0+IHtcclxuICAgICAgICAgICAgaWYodGhpcy5wb3NpdGlvbl9oZWxwZXIuaXNTY3JvbGxlZEludG9WaWV3KGFuaW1hdGlvbikpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbmltYXRlKGFuaW1hdGlvbilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmFuaW1hdGlvbnMuZm9yRWFjaCgoYW5pbWF0aW9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLnBvc2l0aW9uX2hlbHBlci5pc1Njcm9sbGVkSW50b1ZpZXcoYW5pbWF0aW9uKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbmltYXRlKGFuaW1hdGlvbilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGFuaW1hdGUoYW5pbWF0aW9uKXtcclxuICAgICAgICBsZXQgYW5pbWF0aW9uX3R5cGUgPSBhbmltYXRpb24uZGF0YXNldC5hbmltYXRpb24gfHwgYW5pbWF0aW9uLmdldEF0dHJpYnV0ZSgnYW5pbWF0aW9uJylcclxuICAgICAgICBsZXQgYW5pbWF0aW9uX3NwZWVkID0gYW5pbWF0aW9uLmRhdGFzZXQuYW5pbWF0aW9uU3BlZWQgfHwgdGhpcy5zcGVlZFxyXG4gICAgICAgIGFuaW1hdGlvbl9zcGVlZCA9IGlzTmFOKGFuaW1hdGlvbl9zcGVlZCkgPyB0aGlzLnNwZWVkIDogYW5pbWF0aW9uX3NwZWVkXHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgdGhpc1thbmltYXRpb25fdHlwZV0gPT09IFwiZnVuY3Rpb25cIikgeyBcclxuICAgICAgICAgICAgdGhpc1thbmltYXRpb25fdHlwZV0oYW5pbWF0aW9uLGFuaW1hdGlvbl9zcGVlZClcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5yZW1vdmVBbmltYXRpb24oYW5pbWF0aW9uKVxyXG4gICAgfVxyXG5cclxuICAgIHR5cGV3cml0ZXIoYW5pbWF0aW9uLHNwZWVkLGZ1bGxfc3RyaW5nID0gXCJcIix0ZW1wX3N0cmluZyA9IFwiXCIsaSA9IDApe1xyXG4gICAgICAgIGZ1bGxfc3RyaW5nID0gZnVsbF9zdHJpbmcubGVuZ3RoID09IDAgPyBhbmltYXRpb24uaW5uZXJIVE1MIDogZnVsbF9zdHJpbmdcclxuICAgICAgICBsZXQgbGltaXQgPSBmdWxsX3N0cmluZy5sZW5ndGhcclxuXHJcbiAgICAgICAgYW5pbWF0aW9uLmlubmVySFRNTCA9IHRlbXBfc3RyaW5nXHJcbiAgICAgICAgdGVtcF9zdHJpbmcgKz0gZnVsbF9zdHJpbmcuY2hhckF0KGkpXHJcblxyXG4gICAgICAgIGFuaW1hdGlvbi5pbm5lckhUTUwgPSB0ZW1wX3N0cmluZyArXCI8c3BhbiBjbGFzcz0ndHlwd3JpdGVyX19ibGluayc+Xzwvc3Bhbj5cIlxyXG5cclxuICAgICAgICBpZihpIDwgbGltaXQpe1xyXG4gICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50eXBld3JpdGVyKGFuaW1hdGlvbixzcGVlZCxmdWxsX3N0cmluZyx0ZW1wX3N0cmluZyxpKVxyXG4gICAgICAgICAgICB9LCBzcGVlZClcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQW5pbWF0aW9uKGFuaW1hdGlvbil7XHJcbiAgICAgICAgYW5pbWF0aW9uLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1hbmltYXRpb24nKVxyXG4gICAgICAgIHRoaXMuYW5pbWF0aW9ucyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1hbmltYXRpb25dXCIpKVxyXG4gICAgfVxyXG59XHJcblxyXG5sZXQgYW5pbWF0aW9ucyA9IG5ldyBBbmltYXRpb25zKClcclxuXHJcbiIsIi8qXHJcbipcclxuQ2hhdEJveCBDbGFzcyAtIGJ5IHNjYXZlbnR1bVxyXG4qXHJcbiovXHJcblxyXG5jbGFzcyBDaGF0Qm94IHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuYXR0cl9oZWxwZXIgPSBuZXcgQXR0ckhlbHBlcigpICBcclxuICAgICAgICB0aGlzLmNoYXRib3ggPSAnJ1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gJydcclxuICAgICAgICB0aGlzLmNoYXRib3hfZm9ybSA9ICcnXHJcbiAgICAgICAgdGhpcy5jaGF0Ym94X2xpc3QgPSAnJ1xyXG4gICAgICAgIHRoaXMuY2hhdGJveF9tZXNzYWdlX2JveCA9ICcnXHJcbiAgICAgICAgdGhpcy53ZWxjb21lID0gJydcclxuICAgICAgICB0aGlzLmluaXRpYXRlZCA9IGZhbHNlXHJcbiAgICB9XHJcblxyXG4gICAgaW5pdCgpIHtcclxuICAgICAgICB0aGlzLmNoYXRib3ggICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0LWJveCcpXHJcbiAgICAgICAgaWYodGhpcy5jaGF0Ym94ICE9PSBudWxsKXtcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIgPSB0aGlzLmNoYXRib3gucGFyZW50Tm9kZVxyXG4gICAgICAgICAgICB0aGlzLmNoYXRib3hfZm9ybSA9IHRoaXMuY2hhdGJveC5xdWVyeVNlbGVjdG9yKCcuY2hhdC1ib3hfX2Zvcm0nKVxyXG4gICAgICAgICAgICB0aGlzLmNoYXRib3hfbGlzdCA9IHRoaXMuY2hhdGJveC5xdWVyeVNlbGVjdG9yKCcuY2hhdC1ib3hfX2xpc3QnKVxyXG4gICAgICAgICAgICB0aGlzLndlbGNvbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd3ZWxjb21lJylcclxuICAgICAgICAgICAgdGhpcy5jaGF0Ym94X21lc3NhZ2VfYm94ID0gdGhpcy5jaGF0Ym94X2Zvcm0ucXVlcnlTZWxlY3RvcignI21lc3NhZ2UnKVxyXG5cclxuICAgICAgICAgICAgdGhpcy5jaGF0Ym94X2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcclxuXHJcbiAgICAgICAgICAgICAgICBpZighdGhpcy5pbml0aWF0ZWQpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdGlhdGVDb250YWluZXIoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuY2hhdCgpXHJcblxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdGlhdGVDb250YWluZXIoKXtcclxuICAgICAgICB0aGlzLmluaXRpYXRlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5hdHRyX2hlbHBlci5yZW1vdmVFbGVtZW50c0J5Q2xhc3ModGhpcy53ZWxjb21lKVxyXG4gICAgICAgIGlmICghdGhpcy5hdHRyX2hlbHBlci5oYXNDbGFzcyh0aGlzLmNvbnRhaW5lciwgJ2gtMTAwJykpIHtcclxuICAgICAgICAgICAgdGhpcy5hdHRyX2hlbHBlci50b2dnbGVDbGFzcyh0aGlzLmNvbnRhaW5lciwgJ2gtMTAwJykgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNoYXQoKSB7XHJcbiAgICAgICAgbGV0IG1lc3NhZ2UgPSB0aGlzLmNoYXRib3hfbWVzc2FnZV9ib3gudmFsdWU7XHJcbiAgICAgICAgdGhpcy5jaGF0Ym94X21lc3NhZ2VfYm94LnZhbHVlID0gJydcclxuXHJcbiAgICAgICAgdGhpcy5pbnNlcnRCdWJibGUobWVzc2FnZSwndGV4dCcsJ2h1bWFuJylcclxuXHJcbiAgICAgICAgbGV0IHB1cmVib3RfbWVzc2FnZSA9ICcnXHJcbiAgICAgICAgbGV0IGludGVyYWN0aXZlID0gZmFsc2VcclxuICAgICAgICBsZXQgYXR0YWNobWVudCA9IG51bGxcclxuICAgICAgICBsZXQgZGF0YSA9IG5ldyBGb3JtRGF0YSgpXHJcbiAgICAgICAgY29uc3QgcG9zdERhdGEgPSB7XHJcbiAgICAgICAgICAgIGRyaXZlcjogJ3dlYicsXHJcbiAgICAgICAgICAgIHVzZXJJZDogJzEnLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxyXG4gICAgICAgICAgICBhdHRhY2htZW50LFxyXG4gICAgICAgICAgICBpbnRlcmFjdGl2ZSxcclxuICAgICAgICAgICAgYXR0YWNobWVudF9kYXRhOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXR0YWNobWVudCcpLmZpbGVzWzBdXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgT2JqZWN0LmtleXMocG9zdERhdGEpLmZvckVhY2goa2V5ID0+IGRhdGEuYXBwZW5kKGtleSwgcG9zdERhdGFba2V5XSkpXHJcblxyXG4gICAgICAgIGF4aW9zLnBvc3QoXCIvYXBpL2JvdG1hblwiLCBkYXRhKS50aGVuKHJlc3BvbnNlID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZXMgPSByZXNwb25zZS5kYXRhLm1lc3NhZ2VzIHx8IFtdO1xyXG4gICAgICAgICAgICBtZXNzYWdlcy5mb3JFYWNoKG1zZyA9PiB7XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMuX2FkZE1lc3NhZ2UobXNnLnRleHQsIG1zZy5hdHRhY2htZW50LCBmYWxzZSwgbXNnKTtcclxuICAgICAgICAgICAgICAgIHB1cmVib3RfbWVzc2FnZSA9IG1zZy50ZXh0XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluc2VydEJ1YmJsZShwdXJlYm90X21lc3NhZ2UsJ3RleHQnLCdwdXJlYm90JylcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBjaGF0KCl7XHJcbiAgICAvLyAgICAgbGV0IG1lc3NhZ2UgPSB0aGlzLmNoYXRib3hfbWVzc2FnZV9ib3gudmFsdWVcclxuICAgIC8vICAgICBsZXQgcHVyZWJvdF9tZXNzYWdlID0nJ1xyXG5cclxuICAgIC8vICAgICB0aGlzLmNoYXRib3hfbWVzc2FnZV9ib3gudmFsdWUgPSAnJ1xyXG4gICAgICAgIFxyXG4gICAgLy8gICAgIHRoaXMuaW5zZXJ0QnViYmxlKG1lc3NhZ2UsJ3RleHQnLCdodW1hbicpXHJcblxyXG4gICAgLy8gICAgIGF4aW9zLnBvc3QoJy9ib3RtYW4nLCB7XHJcbiAgICAvLyAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2VcclxuICAgIC8vICAgICB9KVxyXG4gICAgLy8gICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xyXG4gICAgLy8gICAgICAgICBsZXQgcHVyZWJvdCA9IHJlc3BvbnNlLmRhdGFcclxuICAgIC8vICAgICAgICAgcHVyZWJvdF9tZXNzYWdlID0gcHVyZWJvdC5yZXNwb25zZVxyXG4gICAgLy8gICAgICAgICB0aGlzLmluc2VydEJ1YmJsZShwdXJlYm90X21lc3NhZ2UsJ3RleHQnLCdwdXJlYm90JylcclxuICAgIC8vICAgICB9KVxyXG4gICAgLy8gICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgIC8vICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXHJcbiAgICAvLyAgICAgfSlcclxuICAgIC8vIH1cclxuXHJcbiAgICBpbnNlcnRCdWJibGUobWVzc2FnZSx0eXBlLHNvdXJjZSl7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIltcIit0eXBlK1wiLCBcIitzb3VyY2UrXCJdOiBcIittZXNzYWdlKVxyXG5cclxuICAgICAgICBsZXQgYnViYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7ICAgICAgICAgICAgICAgICBcclxuICAgICAgICBsZXQgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKG1lc3NhZ2UpOyAgICAgIFxyXG4gICAgICAgIGJ1YmJsZS5hcHBlbmRDaGlsZCh0ZXh0KTsgICBcclxuICAgICAgICBidWJibGUuY2xhc3NMaXN0LmFkZChcImNoYXQtYm94X19saXN0X19idWJibGVcIikgICAgXHJcbiAgICAgICAgYnViYmxlLmNsYXNzTGlzdC5hZGQoXCJjaGF0LWJveF9fbGlzdF9fYnViYmxlX19cIitzb3VyY2UpICAgICAgICAgICAgIFxyXG5cclxuICAgICAgICB0aGlzLmNoYXRib3hfbGlzdC5hcHBlbmRDaGlsZChidWJibGUpO1xyXG4gICAgICAgIHRoaXMuY2hhdGJveF9saXN0LnNjcm9sbFRvcCA9IHRoaXMuY2hhdGJveF9saXN0LnNjcm9sbEhlaWdodDtcclxuXHJcbiAgICAgICAgdGhpcy5jaGF0Ym94X21lc3NhZ2VfYm94LmZvY3VzKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmxldCBjaGF0Ym94ID0gbmV3IENoYXRCb3goKSIsIi8qXHJcbipcclxuU2lkZUJhciBDbGFzcyAtIGJ5IHNjYXZlbnR1bSBmcm9tIFB1cmUuY3NzXHJcbipcclxuKi9cclxuXHJcbmNsYXNzIFNpZGVCYXIge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5hdHRyX2hlbHBlciA9IG5ldyBBdHRySGVscGVyKClcclxuICAgIH1cclxuXHJcbiAgICBpbml0KCkge1xyXG4gICAgICAgIHZhciBsYXlvdXQgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsYXlvdXQnKSxcclxuICAgICAgICAgICAgbWVudSAgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVudScpLFxyXG4gICAgICAgICAgICBtZW51TGluayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZW51TGluaycpLFxyXG4gICAgICAgICAgICBjb250ZW50ICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJylcclxuXHJcbiAgICAgICAgbGV0IHRvZ2dsZWRFbGVtZW50ID0gW1xyXG4gICAgICAgICAgICBsYXlvdXQsXHJcbiAgICAgICAgICAgIG1lbnUsXHJcbiAgICAgICAgICAgIG1lbnVMaW5rXHJcbiAgICAgICAgXSxcclxuICAgICAgICBhY3RpdmUgPSAnYWN0aXZlJ1xyXG5cclxuICAgICAgICBtZW51TGluay5vbmNsaWNrID0gKGUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy50b2dnbGVTaWRlQmFyKGUsIHRvZ2dsZWRFbGVtZW50LCBhY3RpdmUpXHJcbiAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgIGNvbnRlbnQub25jbGljayA9IChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmF0dHJfaGVscGVyLmhhc0NsYXNzKG1lbnUsYWN0aXZlKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVTaWRlQmFyKGUsIHRvZ2dsZWRFbGVtZW50LCBhY3RpdmUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZVNpZGVCYXIoZSwgZWxlbWVudHMsIGFjdGl2ZSkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgIGVsZW1lbnRzLmZvckVhY2goKGVsZW1lbnQpID0+IHsgXHJcbiAgICAgICAgICAgIHRoaXMuYXR0cl9oZWxwZXIudG9nZ2xlQ2xhc3MoZWxlbWVudCwgYWN0aXZlKSBcclxuICAgICAgICB9KSBcclxuICAgIH1cclxufVxyXG5cclxubGV0IHNpZGVCYXIgPSBuZXcgU2lkZUJhcigpXHJcbiJdfQ==
